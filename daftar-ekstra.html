<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Daftar Ekstra - SMA Negeri 1 Turen</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f7f7f7; }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #a0aec0; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background-color: #edf2f7; }
    </style>
</head>
<body class="antialiased bg-gray-50 min-h-screen">
<header class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
        <div class="flex items-center space-x-3">
            <img src="gambar/Adobe Express - file.png" alt="Logo" class="h-12 w-12 object-contain">
            <div class="text-2xl font-bold text-gray-800">SMA Negeri 1 Turen</div>
        </div>
        <nav class="flex space-x-4 items-center">
            <button onclick="showProfil()" class="text-sm font-medium text-indigo-600 border border-indigo-500 rounded-lg px-3 py-1 hover:bg-indigo-50">Profil Saya</button>
            <button onclick="handleLogout()" class="text-sm font-medium text-red-600 border border-red-500 rounded-lg px-3 py-1 hover:bg-red-50">Log Out</button>
            <a href="notif.html" class="text-gray-600 p-1 rounded-full hover:text-indigo-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1" />
                </svg>
            </a>
        </nav>
    </div>
</header>
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

<div id="daftar-ekstra-container">
    <div id="welcome-block" class="mb-6 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-6 shadow-lg">
    <h2 id="welcome-message" class="text-2xl font-bold">Memuat data...</h2>
    <p id="welcome-subtext" class="mt-2">Silakan pilih 1 ekstra yang ingin kamu ikuti. Kamu hanya boleh mengikuti 1 ekstra.</p>
</div>
    <h1 class="text-3xl text-gray-800 mb-6 border-b pb-2 font-medium">Pilih Ekstra Favoritmu</h1>

    <div id="ekstraList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <p class="text-center py-8 text-gray-500">Memuat data...</p>
    </div>
</div>

<!-- Dashboard siswa (tersembunyi default) -->
<div id="dashboard-siswa" class="hidden">
    <div class="container mx-auto p-4 md:p-8">
        <div class="mb-6 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-6 shadow-lg">
            <h1 class="text-3xl font-bold ">Dashboard Ekstrakurikuler Saya</h1>
            <p class="text-lg">Selamat datang kembali, <span data-nama-siswa></span>!</p>
        </div>

        <div class="mb-6">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex flex-wrap gap-x-6 gap-y-2" aria-label="Tabs">
                    <button class="tab-button active inline-flex items-center py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-blue-600" data-tab-target="#tab-ekstra">Ekstra Saya</button>
                    <button class="tab-button inline-flex items-center py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-blue-600" data-tab-target="#tab-nilai">Nilai & Sertifikat</button>
                    <button class="tab-button inline-flex items-center py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-blue-600" data-tab-target="#tab-lomba">Lomba & Acara</button>
                </nav>
            </div>
        </div>

        <div>
            <!-- Tab Ekstra -->
            <div id="tab-ekstra" data-tab-content>
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Ekstrakurikuler Aktif Saya</h2>
                <div class="grid grid-cols-1 md:max-w-lg gap-6">
                    <div class="bg-white shadow-lg rounded-lg p-6 transition transform hover:-translate-y-1 hover:shadow-xl">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="text-xl font-bold text-gray-900" data-extra-nama></h3>
                            <span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Anggota Aktif</span>
                        </div>
                        <p class="text-gray-700 mb-3" data-extra-deskripsi></p>
                        <ul class="text-gray-700 space-y-2">
                            <li class="flex items-center"><svg class="w-5 h-5 text-blue-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg><span>Jadwal: <strong data-extra-jadwal>Belum tersedia</strong></span></li>
                            <li class="flex items-center"><svg class="w-5 h-5 text-blue-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/></svg><span>Lokasi: <strong data-extra-lokasi>Belum tersedia</strong></span></li>
                            <li class="flex items-center"><svg class="w-5 h-5 text-blue-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg><span>Pembina: <strong data-extra-pembina>Belum ditentukan</strong></span></li>
                        </ul>
                        <button onclick="openModal('Pengumuman', 'Tidak ada pengumuman baru.')" class="mt-6 w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-md">Lihat Pengumuman</button>
                    </div>
                </div>
            </div>

            <!-- Tab Nilai -->
            <div id="tab-nilai" data-tab-content class="hidden">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Nilai Ekstrakurikuler</h2>
                <div class="md:max-w-lg mx-auto">
                    <div class="bg-white shadow-lg rounded-lg p-6">
                        <div class="flex items-center mb-3">
                            <h3 class="text-xl font-bold text-gray-900" data-nilai-extra-nama></h3>
                        </div>
                        <p class="text-5xl font-bold text-center text-blue-600 my-4" id="nilai-angka">-</p>
                        <p class="text-gray-600 italic" id="nilai-komentar">Nilai belum tersedia.</p>
                        <p class="text-sm text-gray-500 mt-2 text-right" id="nilai-guru">-</p>
                    </div>
                </div>

                <div class="mt-6">
                    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Sertifikat Saya</h2>
                    <div class="bg-white shadow-lg rounded-lg overflow-hidden">
                        <ul id="sertifikat-list" class="divide-y divide-gray-200">
                            <li class="p-4 sm:p-6 text-gray-500">Belum ada sertifikat.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Tab Lomba -->
            <div id="tab-lomba" data-tab-content class="hidden">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Lomba & Acara Mendatang</h2>
                <div id="lomba-list" class="space-y-6">
                    <div class="bg-white shadow-lg rounded-lg p-6 flex flex-col md:flex-row items-start">
                        <div class="flex-shrink-0 mb-4 md:mb-0 md:mr-6">
                            <div class="w-24 h-24 bg-red-100 rounded-lg flex flex-col items-center justify-center">
                                <span class="text-4xl font-bold text-red-600">25</span>
                                <span class="text-lg font-semibold text-red-500 -mt-1">DES</span>
                            </div>
                        </div>
                        <div class="flex-grow">
                            <span class="inline-block bg-red-100 text-red-800 text-xs font-semibold px-2 py-1 rounded-full mb-2 uppercase">Kompetisi</span>
                            <h3 class="text-xl font-bold text-gray-900">Kompetisi Ekstra</h3>
                            <p class="text-gray-600 mb-4">Informasi lomba akan diumumkan pembina.</p>
                        </div>
                        <div class="flex-shrink-0 mt-4 md:mt-0 md:ml-6">
                            <button onclick="openModal('Info Lomba', 'Detail pendaftaran akan diumumkan.')" class="inline-block bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-md">Info Lanjut</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Modal pop-up untuk dashboard -->
    <div id="modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40"></div>
    <div id="modal-container" class="hidden fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-xl z-50 p-6 w-11/12 md:max-w-md">
        <div class="flex justify-between items-center mb-4">
            <h3 id="modal-title" class="text-xl font-bold text-gray-900">Judul</h3>
            <button id="modal-close-btn" class="text-gray-400 hover:text-gray-600"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
        </div>
        <div id="modal-content" class="text-gray-700"></div>
    </div>
</div>

</main>
<!-- Modal Profil -->
<div id="profil-modal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 hidden z-50">
    <div class="bg-white rounded-xl w-full max-w-md shadow-2xl p-6">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold text-gray-800">Profil Saya</h3>
            <button onclick="closeProfilModal()" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times"></i></button>
        </div>
        <div id="profil-content" class="space-y-4">
            <p class="text-center text-gray-500">Memuat profil...</p>
        </div>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
<script>
    // util: escape single quote untuk query SELECT yang menggunakan template string
    function esc(s) { return (s === null || s === undefined) ? '' : String(s).replace(/'/g, "''"); }

    let db;
    let currentUser = null;

    function checkLogin() {
        const savedUser = localStorage.getItem('currentUser');
        if (!savedUser) {
            alert('Anda harus login terlebih dahulu!');
            window.location.href = 'index.html';
            return false;
        }
        currentUser = JSON.parse(savedUser);
        return true;
    }

    initSqlJs().then(function(SQL){
        const savedDb = localStorage.getItem('db');
        if (savedDb) {
            const data = JSON.parse(savedDb);
            const buffer = new Uint8Array(data);
            db = new SQL.Database(buffer);
        } else {
            db = new SQL.Database();
        }

        // Perbaikan: Migrasi skema
        try {
            // Cek apakah tabel ekstra sudah ada
            const tables = db.exec("SELECT name FROM sqlite_master WHERE type='table' AND name='ekstra';");
            if (tables.length === 0) {
                // Jika tabel tidak ada, buat semua tabel dari awal
                db.run(`
                    CREATE TABLE ekstra (
                        id INTEGER PRIMARY KEY AUTOINCREMENT,
                        nama TEXT NOT NULL,
                        deskripsi TEXT,
                        foto TEXT,
                        jadwal TEXT,
                        lokasi TEXT,
                        pembina TEXT
                    );
                    CREATE TABLE pendaftaran (
                        id INTEGER PRIMARY KEY AUTOINCREMENT,
                        nama_peserta TEXT,
                        nis_peserta TEXT,
                        ekstra TEXT NOT NULL,
                        status TEXT DEFAULT 'menunggu'
                    );
                    CREATE TABLE peserta (
                        id INTEGER PRIMARY KEY AUTOINCREMENT,
                        nama TEXT NOT NULL,
                        nis TEXT UNIQUE NOT NULL,
                        kelas TEXT,
                        no_hp TEXT,
                        password TEXT NOT NULL
                    );
                `);
            } else {
                // Jika tabel ekstra sudah ada, cek kolom-kolom tambahan
                const columns = db.exec("PRAGMA table_info(ekstra);");
                const columnNames = columns[0]?.values.map(col => col[1]) || [];
                
                if (!columnNames.includes('jadwal')) {
                    db.run("ALTER TABLE ekstra ADD COLUMN jadwal TEXT;");
                }
                if (!columnNames.includes('lokasi')) {
                    db.run("ALTER TABLE ekstra ADD COLUMN lokasi TEXT;");
                }
                if (!columnNames.includes('pembina')) {
                    db.run("ALTER TABLE ekstra ADD COLUMN pembina TEXT;");
                }
            }
        } catch (e) {
            console.error("Gagal memperbarui skema database:", e);
            alert("Gagal memperbarui skema database. Silakan hapus data situs dan coba lagi.");
            return; // Hentikan eksekusi jika migrasi gagal
        }

        // simpan periodik
        setInterval(() => {
            try {
                const data = db.export();
                const buffer = new Uint8Array(data);
                localStorage.setItem('db', JSON.stringify(Array.from(buffer)));
            } catch (e) { console.error(e); }
        }, 1000);

        if (checkLogin()) {
            document.getElementById('welcome-message').textContent = `Selamat Datang, ${currentUser.nama}!`;
            tampilkanEkstra();
            cekStatusDiterima();
        }
    }).catch(err => {
        console.error('Gagal inisialisasi SQL.js', err);
        alert('Gagal memuat database. Buka lewat local server jika perlu.');
    });

    function handleLogout() {
        if (confirm('Yakin ingin logout?')) {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }
    }

    function showProfil() {
        // ambil pendaftaran user ini (semua status)
        const q = db.exec(`
            SELECT ekstra, status FROM pendaftaran WHERE nis_peserta = '${esc(currentUser.nis)}'
        `);

        const profilContent = document.getElementById('profil-content');
        profilContent.innerHTML = `
            <div class="flex items-center"><i class="fas fa-user text-indigo-600 mr-3"></i><span class="text-gray-700"><strong>Nama:</strong> ${currentUser.nama}</span></div>
            <div class="flex items-center"><i class="fas fa-id-card text-indigo-600 mr-3"></i><span class="text-gray-700"><strong>NIS:</strong> ${currentUser.nis}</span></div>
            <div class="flex items-center"><i class="fas fa-school text-indigo-600 mr-3"></i><span class="text-gray-700"><strong>Kelas:</strong> ${currentUser.kelas || '-'}</span></div>
            <div class="flex items-center"><i class="fas fa-phone text-indigo-600 mr-3"></i><span class="text-gray-700"><strong>No. HP:</strong> ${currentUser.no_hp || 'Belum diisi'}</span></div>
            <div class="pt-4 border-t"><h4 class="font-semibold text-gray-800 mb-2">Ekstra yang Diikuti</h4><ul id="ekstra-ikut-list" class="list-disc pl-5 text-gray-600"><li>Memuat data...</li></ul></div>
        `;

        const listEl = document.getElementById('ekstra-ikut-list');
        if (q.length > 0 && q[0].values.length > 0) {
            listEl.innerHTML = '';
            q[0].values.forEach(r => {
                const li = document.createElement('li');
                li.textContent = `${r[0]} (${r[1]})`;
                listEl.appendChild(li);
            });
        } else {
            listEl.innerHTML = '<li>Belum ada ekstra yang diikuti</li>';
        }

        document.getElementById('profil-modal').classList.remove('hidden');
    }

    function closeProfilModal() {
        document.getElementById('profil-modal').classList.add('hidden');
    }

    function tampilkanEkstra() {
        const cek = db.exec(`SELECT COUNT(*) AS total FROM pendaftaran WHERE nis_peserta = '${esc(currentUser.nis)}'`);
        const sudahMendaftar = (cek[0]?.values[0][0] || 0) > 0;

        const result = db.exec(`
            SELECT e.id, e.nama, e.deskripsi, e.foto, IFNULL((SELECT COUNT(*) FROM pendaftaran p WHERE p.ekstra = e.nama), 0) AS jumlah_pendaftar, e.jadwal, e.lokasi, e.pembina
            FROM ekstra e
        `);

        const container = document.getElementById('ekstraList');
        if (result.length === 0 || result[0].values.length === 0) {
            container.innerHTML = '<p class="text-center py-12 text-gray-500 text-lg">Belum ada ekstra yang tersedia.</p>';
            return;
        }

        container.innerHTML = '';
        result[0].values.forEach(row => {
            const id = row[0], nama = row[1], deskripsi = row[2] || 'Tidak ada deskripsi', foto = row[3] || 'https://placehold.co/600x400?text=No+Image', jumlah = row[4] || 0, jadwal = row[5] || 'Belum tersedia', lokasi = row[6] || '-', pembina = row[7] || '-';

            const div = document.createElement('div');
            div.className = 'bg-white rounded-xl shadow-lg overflow-hidden transform transition duration-300 hover:scale-[1.02] hover:shadow-xl';
            const tombolDaftar = sudahMendaftar
                ? `<button class="bg-gray-400 text-white px-4 py-2 rounded-lg cursor-not-allowed" disabled><i class="fas fa-check mr-1"></i> Sudah Daftar</button>`
                : `<button class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white px-4 py-2 rounded-lg shadow-md" onclick="daftarEkstra('${esc(nama)}', '${esc(deskripsi)}', '${esc(jadwal)}', '${esc(lokasi)}', '${esc(pembina)}')"><i class="fas fa-user-plus mr-1"></i> Daftar</button>`;

            div.innerHTML = `
                <img src="${foto}" class="w-full h-48 object-cover" alt="${nama}">
                <div class="p-5">
                    <div class="flex items-center mb-3"><span class="bg-indigo-100 text-indigo-800 text-xs font-semibold px-2.5 py-0.5 rounded">Ekstra</span></div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">${nama}</h3>
                    <p class="text-gray-600 mb-4 line-clamp-2">${deskripsi}</p>
                    <div class="flex justify-between items-center">
                        ${tombolDaftar}
                        <span class="text-gray-500 text-sm flex items-center"><i class="fas fa-users mr-1"></i> ${jumlah} pendaftar</span>
                    </div>
                </div>
            `;
            container.appendChild(div);
        });
    }

    function daftarEkstra(namaEkstra, deskripsi='', jadwal='', lokasi='', pembina='') {
        // cek sekali lagi untuk safety
        const cek = db.exec(`SELECT COUNT(*) AS total FROM pendaftaran WHERE nis_peserta = '${esc(currentUser.nis)}'`);
        if ((cek[0]?.values[0][0] || 0) > 0) {
            alert('Kamu hanya boleh mendaftar ke 1 ekstra.');
            return;
        }

        try {
            db.run("INSERT INTO pendaftaran (nama_peserta, nis_peserta, ekstra, status) VALUES (?, ?, ?, 'menunggu')", [currentUser.nama, currentUser.nis, namaEkstra]);
            alert(`Berhasil mendaftar ke ekstra: ${namaEkstra}`);
            tampilkanEkstra();
            // setelah daftar, cek status (tetap menunggu sampai admin menerima)
            cekStatusDiterima();
        } catch (e) {
            console.error(e);
            alert('Gagal mendaftar. Coba lagi.');
        }
    }

    function cekStatusDiterima() {
        // hanya jika ada user
        if (!currentUser) return;
        const q = db.exec(`SELECT ekstra, status FROM pendaftaran WHERE nis_peserta = '${esc(currentUser.nis)}' LIMIT 1`);
        if (q.length > 0 && q[0].values.length > 0) {
            const namaEkstra = q[0].values[0][0];
            const status = q[0].values[0][1];
            if (status === 'diterima') {
                tampilkanDashboard(namaEkstra);
            } else {
                // tetap tampilkan daftar jika belum diterima
                document.getElementById('daftar-ekstra-container').classList.remove('hidden');
                document.getElementById('dashboard-siswa').classList.add('hidden');
            }
        } else {
            // belum mendaftar
            document.getElementById('daftar-ekstra-container').classList.remove('hidden');
            document.getElementById('dashboard-siswa').classList.add('hidden');
        }
    }

    function tampilkanDashboard(namaEkstra) {
        // sembunyikan daftar, tampilkan dashboard
        document.getElementById('daftar-ekstra-container').classList.add('hidden');
        document.getElementById('dashboard-siswa').classList.remove('hidden');

        document.querySelector('[data-nama-siswa]').textContent = currentUser.nama || '-';

        // ambil info ekstra
        const q = db.exec(`SELECT nama, deskripsi, jadwal, lokasi, pembina FROM ekstra WHERE nama = '${esc(namaEkstra)}' LIMIT 1`);
        if (q.length > 0 && q[0].values.length > 0) {
            const r = q[0].values[0];
            document.querySelector('[data-extra-nama]').textContent = r[0] || namaEkstra;
            document.querySelector('[data-extra-deskripsi]').textContent = r[1] || 'Tidak ada deskripsi';
            document.querySelector('[data-extra-jadwal]').textContent = r[2] || 'Belum tersedia';
            document.querySelector('[data-extra-lokasi]').textContent = r[3] || '-';
            document.querySelector('[data-extra-pembina]').textContent = r[4] || '-';

            // isi nilai contoh dan sertifikat (placeholder)
            document.querySelector('[data-nilai-extra-nama]').textContent = r[0] || namaEkstra;
            // contoh nilai statis, bisa diganti dengan tabel nilai nanti
            document.getElementById('nilai-angka').textContent = 'A-';
            document.getElementById('nilai-komentar').textContent = '"Kinerja baik. Tingkatkan konsistensi latihan."';
            document.getElementById('nilai-guru').textContent = '- ' + (r[4] || 'Pembina');

            // contoh sertifikat
            const sertList = document.getElementById('sertifikat-list');
            sertList.innerHTML = `
                <li class="p-4 sm:p-6 flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div class="flex items-center mb-3 sm:mb-0">
                        <svg class="w-10 h-10 text-green-500 mr-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 00-5.234 0 3.066 3.066 0 00-1.48 5.039c-.046.196-.057.41-.04.622.017.21.05.414.1.608.066.26.14.51.23.75.087.238.18.47.28.693.1.22.21.434.32.64.11.204.23.4.35.584.12.18.25.35.38.51.13.16.27.31.42.45.15.14.3.28.46.4.16.12.33.23.5.33.17.1.35.19.53.27.18.08.37.15.56.2.19.05.39.09.59.12.2.03.4.05.6.06.2.01.4.01.6 0 .2-.01.4-.02.6-.06.2-.04.39-.08.59-.12.19-.05.38-.09.56-.2.18-.08.35-.16.53-.27.17-.1.34-.2.5-.33.16-.12.31-.24.46-.4.15-.14.29-.29.42-.45.13-.16.26-.33.38-.51.12-.184.24-.38.35-.584.11-.206.22-.42.32-.64.1-.223.19-.455.28-.693.09-.24.16-.49.23-.75.05-.194.08-.398.1-.608.017-.212.006-.426-.04-.622a3.066 3.066 0 00-1.48-5.039 3.066 3.066 0 00-5.234 0zM10 15a5 5 0 100-10 5 5 0 000 10zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path></svg>
                    <div>
                        <p class="text-base font-semibold text-gray-900">Sertifikat Anggota ${r[0] || namaEkstra} - Tahun Ini</p>
                        <p class="text-sm text-gray-500">Diterbitkan: -</p>
                    </div></div>
                    <button onclick="openModal('Unduh Sertifikat', 'Sertifikat sedang disiapkan.')" class="mt-3 sm:mt-0 w-full sm:w-auto inline-flex items-center px-4 py-2 text-white bg-blue-600 rounded-md">Unduh</button>
                </li>
            `;
        } else {
            document.querySelector('[data-extra-nama]').textContent = namaEkstra;
            document.querySelector('[data-extra-deskripsi]').textContent = 'Data ekstra tidak ditemukan.';
        }
    }

    // modal dashboard
    const modalOverlay = document.getElementById('modal-overlay');
    const modalContainer = document.getElementById('modal-container');
    const modalTitle = document.getElementById('modal-title');
    const modalContent = document.getElementById('modal-content');
    const modalCloseBtn = document.getElementById('modal-close-btn');

    function openModal(title, content) {
        modalTitle.textContent = title;
        modalContent.innerHTML = content;
        modalOverlay.classList.remove('hidden');
        modalContainer.classList.remove('hidden');
    }

    function closeModal() {
        modalContainer.classList.add('hidden');
        modalOverlay.classList.add('hidden');
    }

    modalCloseBtn.addEventListener('click', closeModal);
    modalOverlay.addEventListener('click', closeModal);

    // tab logic
    document.addEventListener('click', function (e) {
        const btn = e.target.closest('[data-tab-target]');
        if (!btn) return;
        const target = document.querySelector(btn.dataset.tabTarget);
        if (!target) return;
        document.querySelectorAll('[data-tab-content]').forEach(tc => tc.classList.add('hidden'));
        document.querySelectorAll('[data-tab-target]').forEach(b => b.classList.remove('active', 'border-blue-500', 'text-blue-600'));
        target.classList.remove('hidden');
        btn.classList.add('active', 'border-blue-500', 'text-blue-600');
    });

    // modal profil close
    document.addEventListener('click', function(e){
        if (e.target.id === 'profil-modal') closeProfilModal();
    });


</script>
</body>
</html>